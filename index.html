<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>ระบบประเมินการแพ้ยา 6 หน้า</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header class="topbar">
    <h1>ระบบประเมินการแพ้ยา</h1>
    <p class="hospital-badge">โรงพยาบาลพระอาจารย์ฝั้น อาจาโร</p>
  </header>

  <!-- เมนูเลือกหน้า -->
  <nav class="tabs">
    <button data-target="page1" class="active">หน้า 1 ผิวหนัง</button>
    <button data-target="page2">หน้า 2 ระบบอื่น</button>
    <button data-target="page3">หน้า 3 Lab</button>
    <button data-target="page4">หน้า 4 Naranjo</button>
    <button data-target="page5">หน้า 5 Timeline</button>
    <button data-target="page6">หน้า 6 ผลการประเมิน</button>
  </nav>

  <main>
    <section id="page1" class="page visible"></section>
    <section id="page2" class="page"></section>
    <section id="page3" class="page"></section>
    <section id="page4" class="page"></section>
    <section id="page5" class="page"></section>
    <section id="page6" class="page"></section>
  </main>

  <!-- โหลดไฟล์โค้ดก่อน แล้วค่อยเขียนสคริปต์หลัก -->
  <script src="data.js"></script>
  <script src="page1.js"></script>
  <script src="page2.js"></script>
  <script src="page3.js"></script> <!-- โหลดสคริปต์ของหน้า 3 -->

  <script>
    // ปุ่มเมนูทุกปุ่ม
    const tabBtns = document.querySelectorAll(".tabs button");
    // ทุกหน้าใน main
    const pages = document.querySelectorAll(".page");

    // flag ว่าเคยวาดหรือยัง
    let page2Rendered = false;
    let page3Rendered = false;

    tabBtns.forEach((btn) => {
      btn.addEventListener("click", () => {
        const target = btn.dataset.target;

        // เปลี่ยนสถานะปุ่ม
        tabBtns.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");

        // ซ่อนทุกหน้า แล้วโชว์หน้าที่เลือก
        pages.forEach((p) => p.classList.remove("visible"));
        const targetPage = document.getElementById(target);
        if (targetPage) targetPage.classList.add("visible");

        // เรนเดอร์หน้า 2 ครั้งแรก
        if (target === "page2" && window.renderPage2 && !page2Rendered) {
          window.renderPage2();
          page2Rendered = true;
        }

        // เรนเดอร์หน้า 3 ครั้งแรก
        if (target === "page3" && window.renderPage3 && !page3Rendered) {
          window.renderPage3();
          page3Rendered = true;
        }
      });
    });

    // หน้า 1 ให้แสดงตั้งแต่โหลดเว็บ
    if (window.renderPage1) {
      window.renderPage1();
    } else {
      document.getElementById("page1").innerHTML = "<p>โหลดหน้า 1 ไม่ได้</p>";
    }
  </script>
</body>
</html>
